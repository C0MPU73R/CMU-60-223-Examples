<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <title>Exercise: I<sup>2</sup>C and SPI</title>
    <style type="text/css">span.eqn { white-space: nowrap; }</style>
    <meta name="description" content="exercise notes">
    <meta name="author" content="garthz">
  </head>
  <body>

    <h4>Objective</h4>
 
    <p>Communicate digital data between an Arduino and a MPU6050 inertial motion sensor an I<sup>2</sup>C bus.</p>

    <p>Please be sure to review the general information about I<sup>2</sup>C and
      SPI in the previous exercise prior to starting this one.</p>

    <p>This exercise will use a
      <a href="https://www.sparkfun.com/products/11028">
	MPU6050 I2C Accelerometer/Gyro inertial sensor module from Sparkfun</a>.  This modules is based on the 
      <a href="https://cdn.sparkfun.com/datasheets/Components/General%20IC/PS-MPU-6000A.pdf">InvenSense MPU-6050 Motion Processing Unit</a>.
      <a href="https://github.com/jrowberg/i2cdevlib/tree/master/Arduino/MPU6050">Example Arduino code</a> is available from github as
      part of the larger <a href="https://github.com/jrowberg/i2cdevlib">i2cdevlib</a>, which provides drivers for many I<sup>2</sup>C devices.
      </p>

    <h4>Steps and observations</h4>
    <ol>
      <li>Download or find the complete <code>MPU6050_DMP6</code> sketch included with the exercise.  This is an
	example from i2cdevlib, reorganized into a self-contained sketch.
	If you have cloned the course materials from github, it will be in the same folder as this page, or it can be
	<a href="http://cmuphyscomp.github.io/physcomp-examples/1_energy-information-transduction/b_arduino-starter/iv_serial-interfaces/1.b.iv.2_MPU6050-IMU-I2C/MPU6050_DMP6/">
	  downloaded direct from github</a>.  Be sure to fetch all top-level
	  files.</li>

      <li>Plug the IMU module into a breadboard and use solid wire to make the
	following five connections from the Arduino to the module. Note
	carefully that this module uses 3.3V, unlike the previous example:
	<ol>
	  <li>3.3V -> VCC</li>
	  <li>GND -> GND</li>
	  <li>A4 -> SDA</li>
	  <li>A5 -> SCL</li>
	  <li>D2 -> INT</li>
	</ol>
      </li>

      <li>Attach the Arduino to your computer and install the sketch.</li>
      <li>Open the Arduino IDE Serial Monitor and make sure it is set to 115200 baud.</li>
      <li>Reset the Arduino.  You should see a wakeup message on the console followed by the following prompt: <code>Send any character to begin DMP programming and demo:</code></li>
      <li>Type a character in the input box and press enter.</li>
      <li>You should see a rapid series of messages in the following form: <code>ypr	-87.92	74.39	1.85</code></li>
      <li>Physically rotate the IMU and watch the numbers change.</li>
    </ol>

    <h4>Comments</h4>

    <p>The sketch is a relatively complex piece of software for a
      microcontroller, and it uses more than half of the available Arduino Uno
      program space.  But it is also solving a complex example of processing 3D
      motion data.</p>

    <p>For a challenge, clone the original i2cdev library from github and
      install it in your Arduino IDE libraries path, then try compiling the
      original unmodified example.</p>

  </body>
</html>
